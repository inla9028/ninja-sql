/*
**
** Based on a (set of) campaign(s), list description, price plan and price plan's description
** (all via db-link to Fokus) and ICIM codes of the price plan and the campaign (aka additional offering).
**
*/
select UNIQUE RTRIM(a.campaign) as "FOKUS_CAMPAIGN", RTRIM(a.campaign_desc) as "FOKUS_CAMPAIGN_DESC"
            , b.pp_code as "FOKUS_PRICE_PLAN", RTRIM(c.soc_description) as "FOKUS_PRICE_PLAN_DESC"
            , d.icim_subscription_type AS "ICIM_PRICEPLAN",
              d.icim_additional_offering AS "ICIM_ADDITIONAL_OFFERING"
  from campaign@fokus a, campaign_commitments@fokus b, soc@fokus c
     , icim_order_to_subscription d
 where RTRIM(a.campaign) = RTRIM(b.campaign)
   and RTRIM(b.pp_code)  = RTRIM(c.soc)
   and sysdate between c.effective_date and nvl(c.expiration_date, sysdate + 1)
   and RTRIM(a.campaign) in (
    'CPKOF12OP'
    , 'KOFWB12N2'
    , 'PKOF12NY'
    , 'PKOF12OP'
    , 'PKOF12OP'
    , 'PKOF12RI'
    , 'PKOF12RI1'
    , 'PKOF12RI2'
    , 'PKOF12RI3'
    , 'PKOF12RI4'
    , 'PKOF12RI5'
    , 'PKOF12RIN'
    , 'PKOF24NY'
    , 'PKOF24OP'
    , 'PKOG12NY'
    , 'PKOG12OP'
    , 'PKOG12OP'
    , 'PKOG12RI1'
    , 'PKOG12RI2'
    , 'PKOG12RI4'
    , 'PKOG12RI5'
    , 'PKOX12NY'
    , 'PKOX12OP'
    , 'PKOX12RB1'
    , 'PKOX12RB2'
    , 'PKOX12RB3'
    , 'PKOX12RC2'
    , 'PKOX12RD1'
    , 'PKOX12RD2'
    , 'PKOX12SB1'
    , 'PKOX12SC1'
    , 'PKOX12SD1'
    , 'PKOX12UP1'
    , 'PKOX12UP2'
    , 'PKOX12UP3'
    , 'PKOX149NY'
    , 'PKOX199NY'
    , 'PKOX49NY'
    , 'PKOX99NY'
    , 'PKOY12OP'
    , 'PKOY12RB1'
    , 'PKOY12RB2'
    , 'PKOY12RB3'
    , 'PKOY12RC2'
    , 'PKOY12RD1'
    , 'PKOY12RD3'
    , 'PKOY12SB1'
    , 'PKOY12SD1'
    , 'PKOY12UP1'
    , 'PKOY12UP2'
    , 'PKOY12UP3'
    , 'PKOY149NY'
    , 'PKOY199NY'
    , 'PKOY49NY'
    , 'PKOY99NY'
    , 'PPUA12RA1'
    , 'PPUA12RA2'
    , 'PPUA12RA3'
    , 'PPUA12RA4'
    , 'PPUA12UP0'
    , 'PPUA12UP1'
    , 'PPUA12UP2'
    , 'PPUA12UP3'
    , 'PPUAUP1 '
    , 'PPUAUP3 '
    , 'PPUB12NY'
    , 'PPUB12OP'
    , 'PPUB12RI1'
    , 'PPUB12RI2'
    , 'PPUB12RI3'
    , 'PPUB12RI4'
    , 'PPUB12SM1'
    , 'PPUB12SPS'
    , 'PPUC12OP'
    , 'PPUC12OP'
    , 'PPUC12RI1'
    , 'PPUC12RI2'
    , 'PPUC12RI3'
    , 'PPUC12RI4'
    , 'PPUC12SM1'
    , 'PPUC12SPS'
    , 'PPUD12OP'
    , 'PPUD12RI1'
    , 'PPUD12RI2'
    , 'PPUD12RI3'
    , 'PPUD12RI4'
    , 'PPUD12SM1'
    , 'PPUD12SPS'
    , 'PPUE12OP'
    , 'PPUE12RI1'
    , 'PPUE12RI2'
    , 'PPUE12SM1'
    , 'PPUE12SPS'
    , 'PPUG12OP'
    , 'PPUG12R1'
    , 'PPUG12R2'
    , 'PPUH12OP'
    , 'PPUI12OP'
    , 'PPUJ12OP'
    , 'PPUJ12OP2'
    , 'PPUJ12R4'
    , 'PPUJ12R5'
    , 'PPUK12OP'
    , 'PPUK12R1'
    , 'PPUK12R2'
    , 'PPUN12OP'
    , 'PPUN12R1'
    , 'PPUN12R2'
    , 'PPUN12R3'
    , 'PPUO12OP'
    , 'PPUO12R1'
    , 'PPUO12R2'
    , 'PPUO12R3'
    , 'PPUP12OP'
    , 'PPUP12R1'
    , 'PPUP12R2'
    , 'PPUP12R3'
    , 'PPUQ12OP'
    , 'PPUQ12R1'
    , 'PPUQ12R2'
    , 'PPUQ12R3'
   )
   and RTRIM(c.soc)      = d.priceplan_code
   and RTRIM(a.campaign) = d.campaign_code
order by RTRIM(a.campaign)
;
