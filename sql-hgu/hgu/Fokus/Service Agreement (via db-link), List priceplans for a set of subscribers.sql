--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==
--== List priceplans for a set of subscribers.
--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==
SELECT a.ban, a.subscriber_no, RTRIM(a.soc) AS "SOC", b.description, a.campaign, a.commit_orig_no_month,
       a.effective_date, a.expiration_date
  FROM service_agreement@fokus a, socs_descriptions b
/*  WHERE a.subscriber_no IN (
        'GSM04741669551', 'GSM04793292666', 'GSM04792477923', 'CDA04755257582'
      )*/
 WHERE a.ban = 850130907
   AND SYSDATE BETWEEN a.effective_date AND NVL(a.expiration_date, TO_DATE('4701', 'YYYY'))
--   AND TO_DATE('2008-12-28', 'YYYY-MM-DD') BETWEEN a.effective_date AND NVL(a.expiration_date, TO_DATE('4701', 'YYYY'))
   AND a.service_type = 'P'
   AND RTRIM(a.soc) = b.soc(+)
--   AND 'NO' = b.language_code
ORDER BY a.subscriber_no, "SOC"
;


--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==
--== List an overview of the priceplans for a set of subscribers.
--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==
SELECT RTRIM(a.soc) AS "PRICEPLAN", b.description, COUNT(*) AS "COUNT"
  FROM service_agreement@fokus a, socs_descriptions b
 WHERE a.subscriber_no IN (
         'GSM04740322637', 'GSM04793001066', 'GSM04740105276', 'GSM04793457965', 'GSM04748355184', 'GSM04745510096', 'GSM04791131808', 'GSM04790686156', 'GSM04792030416', 'GSM04797878358', 'GSM04793648992', 'GSM04799299687', 'GSM04747821217', 'GSM04795762004', 'GSM04792512999', 
         'GSM04792661634', 'GSM04747915501', 'GSM04798685076', 'GSM04790022976', 'GSM04795072703', 'GSM04790254740', 'GSM04793800788', 'GSM04792054485', 'GSM04745394618', 'GSM04745224280', 'GSM04795749473', 'GSM04748366563', 'GSM04795164124', 'GSM04745684590', 'GSM04746443012', 
         'GSM04747231170', 'GSM04747915519', 'GSM04747915520', 'GSM04747915528', 'GSM04740610294', 'GSM04797532329', 'GSM04797706446', 'GSM04793226699', 'GSM04740642573', 'GSM04793009405', 'GSM04745501765', 'GSM04746366155', 'GSM04747915521', 'GSM04745515067', 'GSM04746433125', 
         'GSM04790158842', 'GSM04747918701', 'GSM04747918703', 'GSM04740473600', 'GSM04747918702', 'GSM04790515181', 'GSM04793002126', 'GSM04790043568', 'GSM04745512374', 'GSM04792864809', 'GSM04741203413', 'GSM04795149096', 'GSM04792011288', 'GSM04740473406', 'GSM04741696399', 
         'GSM04745395852', 'GSM04745423014', 'GSM04747915527', 'GSM04790643684', 'GSM04792010541', 'GSM04792012367', 'GSM04795449217', 'GSM04797132101', 'GSM04799546239', 'GSM04799878466', 'GSM04746273493', 'GSM04747915523', 'GSM04745488646', 'GSM04792028221', 'GSM04747915500', 
         'GSM04740760841', 'GSM04792853190', 'GSM04740878128', 'GSM04741677143', 'GSM04799013282', 'GSM04746249744', 'GSM04792426094', 'GSM04798364746', 'GSM04799347071', 'GSM04741072036', 'GSM04792012473', 'GSM04792842807', 'GSM04793633652', 'GSM04745277528', 'GSM04746540386', 
         'GSM04745507870', 'GSM04745503897', 'GSM04747918708', 'GSM04740728113', 'GSM04740728137', 'GSM04740728148', 'GSM04740728218', 'GSM04740728459', 'GSM04740728515', 'GSM04745501040', 'GSM04790798019', 'GSM04747915503', 'GSM04745398486', 'GSM04792235507', 'GSM04792482150', 
         'GSM04740626375', 'GSM04793222427', 'GSM04745513014', 'GSM04745513336', 'GSM04745513353', 'GSM04740103180', 'GSM04747915502', 'GSM04747915525', 'GSM04746749852', 'GSM04792440921', 'GSM04792678973', 'GSM04792800757', 'GSM04792822027', 'GSM04792827098', 'GSM04792876813', 
         'GSM04740723352', 'GSM04746610259', 'GSM04740616756', 'GSM04793006609', 'GSM04746741876'
      )
   AND SYSDATE BETWEEN a.effective_date AND NVL(a.expiration_date, TO_DATE('4701', 'YYYY'))
   AND a.service_type = 'P'
   AND RTRIM(a.soc) = b.soc(+)
   AND 'NO' = b.language_code
GROUP BY RTRIM(a.soc), b.description
ORDER BY RTRIM(a.soc)
;